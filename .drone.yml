---
kind: pipeline
type: docker
name: Check messages.po

clone:
  disable: true

trigger:
  event:
    - pull_request

steps:
  - name: clone friendica base
    image: alpine/git
    commands:
      - git clone https://github.com/friendica/friendica.git .
      - git checkout $DRONE_COMMIT_BRANCH
  - name: clone friendica addon
    image: alpine/git
    commands:
      - git clone $DRONE_REPO_LINK addon
      - cd addon/
      - git checkout $DRONE_COMMIT_BRANCH
      - git fetch origin $DRONE_COMMIT_REF
      - git merge $DRONE_COMMIT_SHA
  - name: Run Xgettext for addons
    image: friendicaci/transifex
    commands:
      - /xgettext-addon.sh
  - name: Check update necessary
    image: friendicaci/transifex
    commands:
      - /check-addons.sh
